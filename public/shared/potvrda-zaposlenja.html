<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Potvrda o zaposlenju</title>
    <link rel="canonical" href="https://summasummarum.me/potvrda-zaposlenja.html" />
    
    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/shared/images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/shared/images/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/shared/images/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="/shared/site.webmanifest" />

    <!-- Dynamic Favicon Script - automatski menja putanje na osnovu domena -->
    <script src="/shared/components/dynamic-favicon.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- PDF/Word Export libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Export Utils module -->
    <script src="/shared/components/export-utils.js"></script>
    <style>
      body {
        font-family: 'Times New Roman', serif;
        background-color: #f8f9fa;
        padding: 20px;
      }
      .document-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        min-height: 297mm;
        padding: 40px;
      }
      .header {
        text-align: center;
        margin-bottom: 40px;
      }
      .title {
        font-size: 24px;
        font-weight: bold;
        margin: 20px 0;
        text-transform: uppercase;
      }
      .content {
        line-height: 1.8;
        text-align: justify;
      }
      .signature-section {
        margin-top: 80px;
        text-align: center;
      }
      .print-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }
      @media print {
        .print-btn {
          display: none;
        }
        body {
          background: white;
          padding: 0;
        }
        .document-container {
          box-shadow: none;
        }
      }

      /* Kompaktna dugmad kao na ugovoru o radu - desna strana */
      .print-button,
      .pdf-button,
      .word-button {
        position: fixed;
        right: 20px;
        padding: 8px 12px;
        border: none;
        border-radius: 5px;
        color: white;
        font-size: 12px;
        font-weight: bold;
        cursor: pointer;
        z-index: 1000;
        min-width: 80px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .print-button {
        top: 20px;
        background-color: #007bff;
      }

      .pdf-button {
        top: 80px;
        background-color: #dc3545;
      }

      .word-button {
        top: 140px;
        background-color: #6f42c1;
      }

      .print-button:hover,
      .pdf-button:hover,
      .word-button:hover {
        opacity: 0.8;
        transform: translateY(-1px);
      }

      /* Sakrij dugmad tokom ≈°tampe */
      @media print {
        .print-button,
        .pdf-button,
        .word-button,
        .print-btn {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- Export dugmad - kompaktno sa desne strane -->
    <button class="print-button" onclick="window.print()">üñ®Ô∏è ≈†tampaj</button>
    <button class="pdf-button" onclick="downloadPDF()">üìÑ PDF</button>
    <button class="word-button" onclick="downloadWord()">üìù Word</button>

    <div class="document-container">
      <div class="header">
        <div id="firmaHeader">
          <h3 id="firmaNaziv">Uƒçitavanje...</h3>
          <p id="firmaAdresa">Uƒçitavanje...</p>
        </div>
      </div>

      <div class="title">POTVRDA O ZAPOSLENJU</div>

      <div class="content">
        <p>
          Potvrƒëuje se da je <strong id="radnikIme">_________________</strong>,
          JMBG <strong id="radnikJmbg">_________________</strong>, zaposlen/a u
          <strong id="firmaNazivText">_________________</strong> sa sjedi≈°tem u
          <strong id="firmaAdresaText">_________________</strong>, PIB
          <strong id="firmaPib">_________________</strong>.
        </p>

        <p><strong>Podaci o zaposlenju:</strong></p>
        <ul>
          <li>
            <strong>Radno mijesto:</strong>
            <span id="radnikPozicija">_________________</span>
          </li>
          <li>
            <strong>Datum zaposlenja:</strong>
            <span id="datumZaposlenja">_________________</span>
          </li>
          <li>
            <strong>Vrsta ugovora:</strong>
            <span id="vrstaUgovora">_________________</span>
          </li>
          <li>
            <strong>Tip ugovora:</strong>
            <span id="tipUgovora">_________________</span>
          </li>
          <li>
            <strong>Radno vrijeme:</strong>
            <span id="radnoVreme">_________________</span>
          </li>
          <li>
            <strong>Visina zarade:</strong>
            <span id="visinaZarade">_________________</span> EUR
          </li>
        </ul>

        <p>
          Zaposleni/a redovno izvr≈°ava svoje radne obaveze u skladu sa ugovorom
          o radu i internim aktima poslodavca.
        </p>

        <p>
          Potvrda se izdaje na zahtev zaposlenog/e radi
          <strong id="potvrdaRazlog">_________________</strong>.
        </p>

        <p>Potvrda ne smije biti kori≈°ƒáena u druge svrhe.</p>
      </div>

      <div class="signature-section">
        <p><strong>Mesto i datum:</strong> ________________________</p>
        <br /><br />
        <p><strong>POSLODAVAC</strong></p>
        <br /><br />
        <p>________________________</p>
        <p id="firmaZastupnik">Direktor</p>
        <br />
        <p style="font-size: 12px; margin-top: 30px">MP</p>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const urlParams = new URLSearchParams(window.location.search);
        const radnikId = urlParams.get('radnikId');
        const firmaId = urlParams.get('firmaId');

        if (radnikId && firmaId) {
          loadData(radnikId, firmaId);
        }
      });

      async function loadData(radnikId, firmaId) {
        try {
          // Uƒçitaj podatke o radniku
          const radnikResponse = await fetch(`/api/radnici/id/${radnikId}`);
          const radnik = await radnikResponse.json();

          // Uƒçitaj podatke o firmi
          const firmaResponse = await fetch(`/api/firme/id/${firmaId}`);
          const firma = await firmaResponse.json();

          // Mapiranje tipova ugovora
          const tipUgovoraText = {
            na_neodredjeno: 'Na neodreƒëeno vreme',
            na_odredjeno: 'Na odreƒëeno vreme',
          };

          const vrstaUgovoraText = {
            ugovor_o_radu: 'Ugovor o radu',
            ugovor_o_djelu: 'Ugovor o djelu',
            ugovor_o_dopunskom_radu: 'Ugovor o dopunskom radu',
            autorski_ugovor: 'Autorski ugovor',
          };

          const radnoVremeText = {
            puno_8h: 'Puno radno vreme (8 sati dnevno / 40 sati nedeljno)',
            skraceno_6h:
              'Skraƒáeno radno vreme (6 sati dnevno / 30 sati nedeljno)',
            skraceno_4h:
              'Skraƒáeno radno vreme (4 sata dnevno / 20 sati nedeljno)',
            skraceno_2h:
              'Skraƒáeno radno vreme (2 sata dnevno / 10 sati nedeljno)',
          };

          // Popuni dokument
          document.getElementById('firmaNaziv').textContent = firma.naziv;
          document.getElementById(
            'firmaAdresa'
          ).textContent = `PIB: ${firma.pib} | ${firma.adresa}`;
          document.getElementById('firmaNazivText').textContent = firma.naziv;
          document.getElementById('firmaAdresaText').textContent = firma.adresa;
          document.getElementById('firmaPib').textContent = firma.pib;

          document.getElementById(
            'radnikIme'
          ).textContent = `${radnik.ime} ${radnik.prezime}`;
          document.getElementById('radnikJmbg').textContent = radnik.jmbg;
          document.getElementById('radnikPozicija').textContent =
            radnik.pozicija_naziv || 'Nespecifikovano';

          // Formatiranje datuma
          const datumZaposlenja = radnik.datum_zaposlenja
            ? new Date(radnik.datum_zaposlenja).toLocaleDateString('sr-Latn-RS')
            : 'N/A';
          document.getElementById('datumZaposlenja').textContent =
            datumZaposlenja;

          document.getElementById('vrstaUgovora').textContent =
            vrstaUgovoraText[radnik.vrsta_ugovora] || 'N/A';
          document.getElementById('tipUgovora').textContent =
            tipUgovoraText[radnik.tip_ugovora] || 'N/A';
          document.getElementById('radnoVreme').textContent =
            radnoVremeText[radnik.tip_radnog_vremena] || 'N/A';
          document.getElementById('visinaZarade').textContent =
            radnik.visina_zarade || '0';
        } catch (error) {
          console.error('Gre≈°ka pri uƒçitavanju podataka:', error);
        }
      }
      // Dinamiƒçki ubaci razlog iz URL-a
      (function () {
        const urlParams = new URLSearchParams(window.location.search);
        const razlog = urlParams.get('razlog');
        if (razlog) {
          document.getElementById('potvrdaRazlog').textContent = razlog;
        }
      })();

      // ============================================
      // EXPORT FUNKCIJE - koristi ExportUtils modul
      // ============================================

      async function downloadPDF() {
        await ExportUtils.exportToPDF({
          containerSelector: '.document-container',
          filePrefix: 'Potvrda_Zaposlenja',
          getFileName: () => {
            const radnikIme =
              document.getElementById('radnikImePrezime')?.textContent ||
              'Radnik';
            const firmaNaziv =
              document.getElementById('firmaNaziv')?.textContent || 'Firma';
            return `Potvrda_Zaposlenja_${radnikIme.replace(
              /\s+/g,
              '_'
            )}_${firmaNaziv.replace(/\s+/g, '_')}.pdf`;
          },
        });
      }

      function downloadWord() {
        ExportUtils.exportToWord({
          containerSelector: '.document-container',
          filePrefix: 'Potvrda_Zaposlenja',
          compact: true,
          getFileName: () => {
            const radnikIme =
              document.getElementById('radnikImePrezime')?.textContent ||
              'Radnik';
            const firmaNaziv =
              document.getElementById('firmaNaziv')?.textContent || 'Firma';
            return `Potvrda_Zaposlenja_${radnikIme.replace(
              /\s+/g,
              '_'
            )}_${firmaNaziv.replace(/\s+/g, '_')}.doc`;
          },
        });
      }
    </script>
  </body>
</html>
