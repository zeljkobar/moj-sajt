<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Obračun preduzetnika - Summa Summarum</title>

    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/shared/images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/shared/images/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/shared/images/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="/shared/site.webmanifest" />

    <!-- Dynamic Favicon Script -->
    <script src="/shared/components/dynamic-favicon.js"></script>

    <!-- Theme Preloader -->
    <script src="/shared/components/theme-preloader.js"></script>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="/shared/global-components.css" rel="stylesheet" />
    <link href="/shared/style.css" rel="stylesheet" />
    <style>
      .calculation-form {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 2rem;
        margin-bottom: 2rem;
      }
      .results-container {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 2rem;
        opacity: 0.5;
        transition: opacity 0.3s ease;
      }
      .results-container.active {
        opacity: 1;
      }
      .input-group-text {
        background-color: #f8f9fa;
        font-weight: 500;
      }
      .header-icon {
        color: #2196f3;
        margin-right: 0.5rem;
      }
      .result-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        margin-bottom: 0.5rem;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        background: #f8f9fa;
      }
      .result-item.highlight {
        background: #e3f2fd;
        border-color: #2196f3;
        font-weight: 600;
      }
      .result-label {
        font-weight: 500;
      }
      .result-value {
        font-size: 1.1rem;
        font-weight: 600;
        color: #2196f3;
      }

      /* Štampanje - sakrij sve osim rezultata */
      @media print {
        body * {
          visibility: hidden;
        }

        #resultsContainer,
        #resultsContainer * {
          visibility: visible;
        }

        #resultsContainer {
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
        }

        #stampanjeSekcija,
        #loadingSpinner,
        #noResultsMessage {
          display: none !important;
        }

        .container-fluid {
          margin: 0;
          padding: 0;
        }

        h5,
        h6 {
          color: #000 !important;
          font-size: 13px !important;
          margin-bottom: 6px !important;
        }

        .result-value {
          color: #000 !important;
          font-size: 11px !important;
        }

        .result-label {
          font-size: 10px !important;
        }

        .result-item {
          padding: 0.3rem 0.5rem !important;
          margin-bottom: 0.1rem !important;
          font-size: 10px !important;
        }

        .result-item.highlight {
          background: #f0f0f0 !important;
          border: 2px solid #000 !important;
          padding: 0.4rem 0.6rem !important;
        }

        hr {
          margin: 0.3rem 0 !important;
        }

        #osnovicaPodaci,
        #doprinos {
          margin-top: 0.5rem !important;
        }

        .results-container {
          padding: 0.8rem !important;
          font-size: 10px !important;
        }
      }
    </style>
  </head>

  <body>
    <div id="navigation-placeholder"></div>

    <div class="container-fluid main-content">
      <div class="row">
        <div class="col-12">
          <!-- Header -->
          <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
              <h1 class="h3 mb-0">
                <i class="fas fa-calculator header-icon"></i>
                Obračun preduzetnika
              </h1>
              <p class="text-muted mb-0">
                Unesite podatke za kalkulaciju obračuna doprinosa za
                preduzetnika
              </p>
            </div>
            <button
              type="button"
              class="btn btn-outline-secondary"
              onclick="window.history.back()"
            >
              <i class="fas fa-arrow-left me-2"></i>Nazad
            </button>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Leva kolona - Forma -->
        <div class="col-lg-6">
          <div class="calculation-form">
            <h5 class="mb-4">
              <i class="fas fa-edit me-2"></i>
              Unos podataka
            </h5>

            <form id="obracunForm">
              <!-- Ostvareni promet -->
              <div class="mb-3">
                <label for="ostvareniPromet" class="form-label">
                  <i class="fas fa-chart-line me-2"></i>
                  Ostvareni promet (EUR)
                </label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-money-bill-wave"></i>
                  </span>
                  <input
                    type="number"
                    class="form-control"
                    id="ostvareniPromet"
                    step="0.01"
                    placeholder="0.00"
                    required
                  />
                  <span class="input-group-text">EUR</span>
                </div>
              </div>

              <!-- Prosečna zarada -->
              <div class="mb-3">
                <label for="prosjecnaZarada" class="form-label">
                  <i class="fas fa-euro-sign me-2"></i>
                  Prosječna zarada (EUR)
                </label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-wallet"></i>
                  </span>
                  <input
                    type="number"
                    class="form-control"
                    id="prosjecnaZarada"
                    step="0.01"
                    value="1083"
                    placeholder="1083.00"
                    required
                  />
                  <span class="input-group-text">EUR</span>
                </div>
              </div>

              <!-- Početni datum -->
              <div class="mb-3">
                <label for="pocetniDatum" class="form-label">
                  <i class="fas fa-calendar-alt me-2"></i>
                  Početni datum
                </label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-calendar-plus"></i>
                  </span>
                  <input
                    type="date"
                    class="form-control"
                    id="pocetniDatum"
                    required
                  />
                </div>
              </div>

              <!-- Krajnji datum -->
              <div class="mb-3">
                <label for="krajnjiDatum" class="form-label">
                  <i class="fas fa-calendar-check me-2"></i>
                  Krajnji datum
                </label>
                <div class="input-group">
                  <span class="input-group-text">
                    <i class="fas fa-calendar-minus"></i>
                  </span>
                  <input
                    type="date"
                    class="form-control"
                    id="krajnjiDatum"
                    required
                  />
                </div>
              </div>

              <!-- Dugme za izračun -->
              <div class="d-grid">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg"
                  id="izracunajBtn"
                >
                  <i class="fas fa-calculator me-2"></i>
                  Izračunaj obračun
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Desna kolona - Rezultati -->
        <div class="col-lg-6">
          <div class="results-container" id="resultsContainer">
            <h5 class="mb-4">
              <i class="fas fa-chart-bar me-2"></i>
              Rezultat obračuna
            </h5>

            <div id="loadingSpinner" class="text-center d-none">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-2">Izračunavam...</p>
            </div>

            <div id="resultsContent" class="d-none">
              <!-- Period -->
              <div class="result-item">
                <span class="result-label">
                  <i class="fas fa-calendar-range me-2"></i>
                  Period obračuna:
                </span>
                <span class="result-value" id="periodResult">-</span>
              </div>

              <!-- Broj dana -->
              <div class="result-item">
                <span class="result-label">
                  <i class="fas fa-clock me-2"></i>
                  Broj dana:
                </span>
                <span class="result-value" id="brojDanaResult">-</span>
              </div>

              <!-- Ostvareni promet -->
              <div class="result-item">
                <span class="result-label">
                  <i class="fas fa-money-bill-wave me-2"></i>
                  Ostvareni promet:
                </span>
                <span class="result-value" id="prometResult">-</span>
              </div>

              <!-- Prosečna zarada -->
              <div class="result-item">
                <span class="result-label">
                  <i class="fas fa-euro-sign me-2"></i>
                  Prosječna zarada:
                </span>
                <span class="result-value" id="prosjecnaZaradaResult">-</span>
              </div>

              <!-- Dodatni podaci za osnovicu -->
              <div id="osnovicaPodaci" class="mt-3">
                <hr />
                <h6 class="mb-3">
                  <i class="fas fa-chart-pie me-2"></i>
                  Detalji osnovice
                </h6>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-percentage me-2"></i>
                    Procenat osnovice:
                  </span>
                  <span class="result-value" id="procenatOsnoviceResult"
                    >-</span
                  >
                </div>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-calendar-month me-2"></i>
                    Mjesečna osnovica:
                  </span>
                  <span class="result-value" id="mesecnaOsnovicaResult">-</span>
                </div>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-calendar-year me-2"></i>
                    Godišnja osnovica:
                  </span>
                  <span class="result-value" id="godisnjaOsnovicaResult"
                    >-</span
                  >
                </div>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-calendar-day me-2"></i>
                    Dnevna osnovica:
                  </span>
                  <span class="result-value" id="dnevnaOsnovicaResult">-</span>
                </div>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-calculator me-2"></i>
                    Osnovica za period:
                  </span>
                  <span class="result-value" id="osnovaZaPeriodResult">-</span>
                </div>
              </div>

              <!-- Doprinosi -->
              <div id="doprinos" class="mt-3">
                <hr />
                <h6 class="mb-3">
                  <i class="fas fa-coins me-2"></i>
                  Doprinosi
                </h6>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-user-shield me-2"></i>
                    PIO doprinos (10%):
                  </span>
                  <span class="result-value" id="pioDoprinosResult">-</span>
                </div>

                <div class="result-item">
                  <span class="result-label">
                    <i class="fas fa-heartbeat me-2"></i>
                    NZP doprinos (1%):
                  </span>
                  <span class="result-value" id="nzpDoprinosResult">-</span>
                </div>

                <div class="result-item highlight">
                  <span class="result-label">
                    <i class="fas fa-trophy me-2"></i>
                    Ukupno doprinosi:
                  </span>
                  <span class="result-value" id="konacniRezultat">-</span>
                </div>
              </div>

              <!-- Dugme za štampanje -->
              <div
                class="text-center mt-4"
                id="stampanjeSekcija"
                style="display: none"
              >
                <button
                  type="button"
                  class="btn btn-success btn-lg"
                  onclick="stampajRezultat()"
                >
                  <i class="fas fa-print me-2"></i>Štampaj rezultat
                </button>
              </div>
            </div>

            <!-- Poruka kad nema rezultata -->
            <div id="noResultsMessage">
              <div class="text-center text-muted">
                <i class="fas fa-info-circle fa-2x mb-3"></i>
                <p>
                  Unesite potrebne podatke i kliknite "Izračunaj" da biste
                  dobili rezultat obračuna doprinosa za preduzetnika.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading i navigacija -->
    <div id="loading-spinner-placeholder"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/shared/components/navigation.js"></script>
    <script src="/shared/components/loading-spinner.js"></script>
    <script src="obracun-preduzetnika.js"></script>
  </body>
</html>
