<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta char .month-card { border: 1px solid #dee2e6; border-radius: 12px;
    overflow: hidden; transition: all 0.3s ease; min-height: 360px; min-width:
    320px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); }8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plan godišnjeg odmora - Summa Summarum</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="global-components.css" />
    <link rel="stylesheet" href="app-pages.css" />
    <style>
      .calendar-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      }

      .calendar-header {
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        padding: 30px;
        border-radius: 12px 12px 0 0;
      }

      .calendar-header h4 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
      }

      .calendar-header p {
        font-size: 1.1rem;
        margin-bottom: 0;
        opacity: 0.9;
      }

      .month-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 30px;
        padding: 30px;
      }

      @media (max-width: 900px) {
        .month-grid {
          grid-template-columns: 1fr;
        }
      }

      .month-card {
        border: 1px solid #dee2e6;
        border-radius: 12px;
        overflow: hidden;
        transition: all 0.3s ease;
        min-height: 400px;
        min-width: 400px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      }

      .month-card:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        transform: translateY(-3px);
      }

      .month-header {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        padding: 16px;
        font-weight: bold;
        text-align: center;
        border-bottom: 1px solid #dee2e6;
        font-size: 18px;
        color: #2c3e50;
      }

      .days-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        font-size: 16px;
      }

      .day-header {
        background: #e9ecef;
        padding: 16px 8px;
        text-align: center;
        font-weight: bold;
        font-size: 15px;
        color: #495057;
        border-bottom: 2px solid #dee2e6;
        min-height: 48px;
      }

      .day-cell {
        aspect-ratio: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid #f8f9fa;
        position: relative;
        cursor: pointer;
        transition: all 0.2s ease;
        min-height: 48px;
        min-width: 42px;
        font-size: 16px;
        padding: 8px;
        font-weight: 500;
      }

      .day-cell:hover {
        background: #f0f8ff;
      }

      .day-cell.weekend {
        background: #f8f9fa;
        color: #6c757d;
      }

      .day-cell.holiday {
        background: #ffebee;
        color: #d32f2f;
        font-weight: bold;
      }

      .day-cell.vacation-approved {
        background: #e8f5e8;
        color: #2e7d32;
      }

      .day-cell.vacation-pending {
        background: #fff3e0;
        color: #f57c00;
      }

      .day-cell.vacation-rejected {
        background: #ffebee;
        color: #d32f2f;
      }

      .legend {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        padding: 15px 20px;
        background: #f8f9fa;
        border-top: 1px solid #dee2e6;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 12px;
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
      }

      .radnici-sidebar {
        max-height: 600px;
        overflow-y: auto;
      }

      .radnik-item {
        padding: 10px;
        border: 1px solid #dee2e6;
        border-radius: 6px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      /* Novi stilovi za kalendar */
      .month-body {
        padding: 10px;
      }

      .weekdays {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 1px;
        margin-bottom: 5px;
      }

      .weekday {
        background: #e9ecef;
        padding: 8px 4px;
        text-align: center;
        font-weight: bold;
        font-size: 12px;
        color: #495057;
      }

      .days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 1px;
      }

      .day {
        aspect-ratio: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border: 1px solid #f1f3f4;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        background: white;
        font-size: 11px;
      }

      .day:hover {
        background: #f0f8ff;
        transform: scale(1.05);
      }

      .day.empty {
        cursor: default;
        background: #f8f9fa;
      }

      .day.empty:hover {
        background: #f8f9fa;
        transform: none;
      }

      .day.today {
        background: #007bff;
        color: white;
        font-weight: bold;
      }

      .day.holiday {
        background: #ffebee;
        color: #d32f2f;
        font-weight: bold;
      }

      .day.vacation {
        background: #e8f5e8;
        color: #2e7d32;
      }

      .day.holiday.vacation {
        background: linear-gradient(45deg, #ffebee 50%, #e8f5e8 50%);
      }

      .day-number {
        font-weight: 600;
        margin-bottom: 2px;
      }

      .holiday-icon,
      .vacation-icon {
        font-size: 8px;
        opacity: 0.7;
      }

      .holiday-icon {
        color: #d32f2f;
      }

      .vacation-icon {
        color: #2e7d32;
      }

      .radnik-item {
        padding: 12px;
        border-bottom: 1px solid #eee;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }

      .radnik-item:hover {
        background-color: #f8f9fa;
      }

      .radnik-item:last-child {
        border-bottom: none;
      }

      .radnik-item .badge {
        font-size: 11px;
      }

      .radnik-item.selected {
        background-color: #e3f2fd;
        border-color: #2196f3;
      }

      .day.clickable-day {
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .day.available:hover {
        background-color: #e8f5e8;
        border-color: #28a745;
      }

      .day.pending {
        background-color: #fff3cd;
        border-color: #ffc107;
      }

      .day.selected {
        background-color: #d4edda;
        border-color: #28a745;
        font-weight: bold;
      }

      .custom-toast {
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      /* Responsivnost */
      @media (max-width: 1200px) {
        .month-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 768px) {
        .month-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 480px) {
        .month-grid {
          grid-template-columns: 1fr;
        }
      }

      .radnik-item:hover {
        background: #f0f8ff;
        border-color: #007bff;
      }

      .radnik-item.selected {
        background: #e3f2fd;
        border-color: #007bff;
      }

      .print-header {
        display: none;
        text-align: center;
        margin-bottom: 20px;
      }

      @media print {
        .no-print {
          display: none !important;
        }
        .print-header {
          display: block !important;
        }
        .calendar-container {
          box-shadow: none;
        }
        body {
          background: white !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- Print Header (only visible when printing) -->
    <div class="print-header">
      <h2>Plan godišnjeg odmora 2025</h2>
      <p id="printFirmaInfo">Firma: Učitavanje...</p>
      <p>Generisano: <span id="printDate"></span></p>
    </div>

    <!-- Navigation (hidden on print) -->
    <nav class="navbar navbar-expand-lg navbar-dark no-print">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <img
            src="./images/summasummarum_logo.svg"
            alt="Logo"
            width="40"
            height="40"
          />
          Summa Summarum
        </a>
        <div class="navbar-nav ms-auto">
          <button
            class="btn btn-outline-light me-2"
            onclick="goBackToGodisnji()"
          >
            <i class="fas fa-arrow-left me-1"></i>Nazad na godišnje odmore
          </button>
          <button class="btn btn-light" onclick="printPlan()">
            <i class="fas fa-print me-1"></i>Štampaj
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
      <!-- Header -->
      <div class="row mb-4 no-print">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h2>
                <i class="fas fa-calendar me-2 text-primary"></i>Plan godišnjeg
                odmora 2025
              </h2>
              <p class="text-muted mb-0" id="firmaInfo">
                Učitavanje informacija o firmi...
              </p>
            </div>
            <div class="d-flex gap-2">
              <button
                class="btn btn-outline-primary"
                onclick="toggleRadniciSidebar()"
              >
                <i class="fas fa-users me-1"></i>Radnici
              </button>
              <button class="btn btn-primary" onclick="printPlan()">
                <i class="fas fa-print me-1"></i>Štampaj plan
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Help & Legend -->
        <div class="col-12 mb-4 no-print">
          <div class="card">
            <div class="card-header">
              <div class="d-flex justify-content-between align-items-center">
                <h6 class="mb-0">
                  <i class="fas fa-info-circle me-2"></i>Legenda i uputstvo
                </h6>
                <button
                  class="btn btn-sm btn-outline-secondary"
                  onclick="toggleHelp()"
                  id="helpToggleBtn"
                >
                  <i class="fas fa-chevron-down"></i>
                </button>
              </div>
            </div>
            <div class="card-body" id="helpContent" style="display: none">
              <div class="row">
                <div class="col-md-6">
                  <h6>Legenda boja:</h6>
                  <div class="legend-items mb-3">
                    <div class="legend-item mb-2">
                      <div
                        class="legend-color"
                        style="
                          background-color: #dc3545;
                          color: white;
                          text-align: center;
                        "
                      >
                        ★
                      </div>
                      <span>Državni praznici</span>
                    </div>
                    <div class="legend-item mb-2">
                      <div
                        class="legend-color"
                        style="background-color: #007bff"
                      ></div>
                      <span>Odobreni godišnji odmori</span>
                    </div>
                    <div class="legend-item mb-2">
                      <div
                        class="legend-color"
                        style="background-color: #ffc107"
                      ></div>
                      <span>Pending zahtevi za odmor</span>
                    </div>
                    <div class="legend-item mb-2">
                      <div
                        class="legend-color"
                        style="background-color: #28a745"
                      ></div>
                      <span>Dostupni dani (mogu se odabrati)</span>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <h6>Kako koristiti kalendar:</h6>
                  <ul class="small">
                    <li>
                      <strong>Klik na radnika</strong> - filtrira kalendar za
                      tog radnika
                    </li>
                    <li>
                      <strong>Klik na dan</strong> - dodaje novi zahtev za odmor
                    </li>
                    <li>
                      <strong>Drag & drop</strong> - označava period odmora
                    </li>
                    <li><strong>Dupli klik</strong> - otvara detalje dana</li>
                    <li>
                      <strong>"Očisti izbor"</strong> - vraća prikaz svih
                      radnika
                    </li>
                    <li><strong>"Štampaj"</strong> - generiše PDF verziju</li>
                  </ul>
                  <div class="mt-2">
                    <small class="text-muted">
                      <i class="fas fa-lightbulb me-1"></i>
                      Tip: Držite Ctrl/Cmd za označavanje više dana odjednom
                    </small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- Sidebar sa radnicima (skrivena po default) -->
        <div
          class="col-lg-2 no-print"
          id="radniciSidebar"
          style="display: none"
        >
          <div class="card">
            <div class="card-header">
              <h6 class="mb-0">
                <i class="fas fa-users me-2"></i>Radnici
                <button
                  class="btn btn-sm btn-outline-secondary float-end"
                  onclick="clearSelection()"
                >
                  Očisti izbor
                </button>
              </h6>
            </div>
            <div class="card-body radnici-sidebar">
              <div id="radniciLista">
                <div class="text-center text-muted py-3">
                  <i class="fas fa-spinner fa-spin me-2"></i>Učitavanje
                  radnika...
                </div>
              </div>

              <!-- Selection Actions -->
              <div id="selectionActions"></div>
            </div>
          </div>
        </div>

        <!-- Kalendar -->
        <div class="col-lg-12" id="calendarColumn">
          <div class="calendar-container">
            <!-- Calendar Header -->
            <div class="calendar-header">
              <div class="row align-items-center">
                <div class="col">
                  <h3 class="mb-0">Kalendar godišnjih odmora 2025</h3>
                  <p class="mb-0 opacity-75" id="selectedRadnikInfo">
                    Svi radnici
                  </p>
                </div>
                <div class="col-auto">
                  <select
                    class="form-select form-select-sm text-white bg-transparent border-white"
                    id="godinaSelect"
                    onchange="changeYear()"
                  >
                    <option value="2024">2024</option>
                    <option value="2025" selected>2025</option>
                    <option value="2026">2026</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Calendar Grid -->
            <div class="month-grid" id="calendarGrid">
              <!-- Mjeseci će biti generisani dinamički -->
            </div>

            <!-- Legend -->
            <div class="legend">
              <div class="legend-item">
                <div class="legend-color" style="background: #e8f5e8"></div>
                <span>Odobreni odmori</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #fff3e0"></div>
                <span>Na čekanju</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #ffebee"></div>
                <span>Odbačeni / Praznici</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #f8f9fa"></div>
                <span>Vikendi</span>
              </div>
              <div class="legend-item">
                <div
                  class="legend-color"
                  style="background: white; border: 2px solid #dee2e6"
                ></div>
                <span>Radni dani</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="plan-godisnjeg-odmora.js"></script>
  </body>
</html>
