<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Obave≈°tenje o isteku ugovora o radu</title>

    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="images/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="images/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="site.webmanifest" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="cookie-consent.css" />

    <!-- Export Utils - modularni PDF/Word export -->
    <script src="components/export-utils.js"></script>

    <!-- PDF Export biblioteka -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
      body {
        font-family: 'Times New Roman', serif;
        line-height: 1.6;
        background-color: #f8f9fa;
      }
      .document-container {
        max-width: 800px;
        margin: 20px auto;
        background: white;
        padding: 40px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
      }
      .content {
        text-align: justify;
      }
      .signature-section {
        margin-top: 40px;
        text-align: right;
      }
      .print-btn,
      .pdf-btn,
      .word-btn,
      .jpr-btn {
        position: fixed;
        right: 20px;
        z-index: 1000;
        min-width: 120px;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
        justify-content: center;
        color: white;
      }

      .print-btn {
        top: 20px;
        background-color: #007bff;
      }

      .pdf-btn {
        top: 80px;
        background-color: #dc3545;
      }

      .word-btn {
        top: 140px;
        background-color: #6f42c1;
      }

      .jpr-btn {
        top: 200px;
        background-color: #28a745;
      }
      .two-column-section {
        width: 100%;
        border-collapse: collapse;
      }
      .two-column-section td {
        width: 50%;
        vertical-align: top;
      }
      @media print {
        .print-btn,
        .pdf-btn,
        .word-btn,
        .jpr-btn {
          display: none;
        }
        body {
          margin: 0;
          background: white;
          font-size: 13pt;
        }
        .document-container {
          box-shadow: none;
          margin: 0;
          padding: 20px;
          font-size: 13pt;
          line-height: 1.5;
        }
        .two-column-section {
          width: 100% !important;
          border-collapse: collapse !important;
        }
        .two-column-section td {
          width: 50% !important;
          vertical-align: top !important;
        }
        /* Uklanjamo page-break da sve bude na jednoj stranici */
        .potvrda-prijema {
          margin-top: 25px;
          border-top: 1px solid #000;
          padding-top: 20px;
        }
        /* Poveƒáavamo margine za bolje ƒçitanje */
        h2 {
          font-size: 15pt !important;
          margin: 20px 0 !important;
        }
        p {
          margin: 8px 0 !important;
        }
        div {
          margin: 12px 0 !important;
        }
      }
      @media (max-width: 768px) {
        .two-column-section {
          flex-direction: column !important;
          gap: 20px !important;
        }
      }
    </style>
  </head>
  <body>
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è ≈†tampaj</button>
    <button class="pdf-btn" onclick="downloadPDF()">üìÑ PDF</button>
    <button class="word-btn" onclick="downloadWordCompact()">üìù Word</button>
    <button class="jpr-btn" onclick="openJPRForIstek()">üìã Otvori JPR</button>

    <div class="document-container">
      <div
        class="header"
        style="text-align: left; margin-bottom: 30px; line-height: 1.2"
      >
        <p style="margin: 2px 0">
          <span id="nazivFirme">__________________</span> D.o.o.
          <span id="mestoFirme">Bar</span>
        </p>
        <p style="margin: 2px 0">br.<span id="brojResenja">__/25</span></p>
        <p style="margin: 2px 0">
          dana <span id="datumResenja">__________________</span>
        </p>
      </div>

      <div style="margin: 20px 0; text-align: justify; line-height: 1.4">
        <p>
          Na osnovu Zakona o radu ƒçl.143, t.3, /Sl.list CG br.49/08, donosim
          sledeƒáe:
        </p>
      </div>

      <div style="text-align: center; margin: 30px 0">
        <h2 style="font-size: 18pt; font-weight: bold; letter-spacing: 2px">
          RJE≈†ENJE
        </h2>
        <p>o</p>
        <p><strong>prestanku radnog odnosa zaposlenom</strong></p>
      </div>

      <div style="margin: 30px 0; text-align: justify; line-height: 1.6">
        <p style="margin-bottom: 15px">
          <strong><span id="imeRadnika">__________________</span></strong> -
          jmbg. <span id="jmbgRadnika">__________________</span><br />
          prestaje radni odnos - na poziciji
          <span id="pozicijaRadnika">__________________</span>, sa razlogom
          isteka roka na koji je zakljuƒçen ugovor o radu, dana
          <span id="datumIsteka">__________________</span>, koji je istom dan
          prestanka radnog odnosa.
        </p>

        <p style="margin: 15px 0">
          2. Radni odnos zaposlenom prestaje danom uruƒçenja ovog rje≈°enja.
        </p>

        <p style="margin: 15px 0">
          3. Zaposlenom su uredno isplaƒáene zarade, naknade zarada i druga
          primanja koja je ostvario/la zakljuƒçno sa danom isteka ugovora o radu.
        </p>

        <p style="margin: 15px 0">
          4. Radna knji≈æica imenovanom/oj je uredno ovjerena i predata.
        </p>

        <p style="margin: 15px 0">5. Rje≈°enje je konaƒçno.</p>
      </div>

      <div style="margin: 30px 0">
        <p
          style="
            text-align: center;
            font-weight: bold;
            text-decoration: underline;
          "
        >
          Obrazlo≈æenje:
        </p>

        <p style="margin: 15px 0; text-align: justify; line-height: 1.6">
          U skladu sa Zakonom o radu zaposlenom prestaje radni odnos istekom
          ugovora o radu.
        </p>

        <p style="margin: 15px 0; text-align: justify; line-height: 1.6">
          Istekom roka na koji je zakljuƒçen ugovor o radu, dana
          <span id="datumIsteka2">__________________</span>, stekli su se uslovi
          za donesenje odluke kao u dispozitivu..
        </p>
      </div>

      <div style="margin: 40px 0; text-align: center">
        <p>
          <strong
            ><span id="nazivFirme2">__________________</span> D.O.O.
            <span id="mestoFirme2">Bar</span></strong
          >
        </p>
        <p style="margin: 20px 0">
          <strong
            >Dir. <span id="zastupnikFirme">__________________</span></strong
          >
        </p>
        <p style="margin: 30px 0">____________________</p>
        <p style="font-size: 10pt">[potpis i peƒçat]</p>
      </div>

      <div
        class="potvrda-prijema"
        style="margin-top: 40px; border-top: 2px solid #000; padding-top: 20px"
      >
        <p
          style="
            text-align: center;
            font-weight: bold;
            text-decoration: underline;
          "
        >
          Pouka o pravnom lijeku:
        </p>

        <p style="margin: 15px 0; text-align: justify; line-height: 1.6">
          Zaposleni o radu od 15 dana od dana prijema rje≈°enja, mo≈æe pokrenuti
          spor pred nadle≈ænim sudom.
        </p>
      </div>
    </div>

    <script>
      // Dobijanje podataka iz URL parametara
      const urlParams = new URLSearchParams(window.location.search);
      const radnikId = urlParams.get('radnikId');
      const firmaId = urlParams.get('firmaId');
      const otkazId = urlParams.get('otkazId');

      // Funkcija za uƒçitavanje podataka i popunjavanje dokumenta
      async function loadAndPopulateDocument() {
        try {
          console.log(
            'Uƒçitavam podatke za radnikId:',
            radnikId,
            'firmaId:',
            firmaId,
            'otkazId:',
            otkazId
          );

          // Proveri da li je otkazId validan
          if (!otkazId) {
            alert(
              'GRE≈†KA: Dokument se mora otvoriti sa validnim otkaz ID-jem. Molimo vas da kliknete na dugme "Otkaz" iz liste radnika.'
            );
            window.close();
            return;
          }

          // Uƒçitaj podatke o radniku
          const radnikResponse = await fetch(`/api/radnici/id/${radnikId}`);
          const radnik = await radnikResponse.json();
          console.log('Radnik podatci:', radnik);

          // Uƒçitaj podatke o firmi
          const firmaResponse = await fetch(`/api/firme/id/${firmaId}`);
          const firma = await firmaResponse.json();
          console.log('Firma podatci:', firma);

          // Uƒçitaj pozicije
          const pozicijeResponse = await fetch('/api/pozicije');
          let pozicije = [];
          let pozicija = null;

          if (pozicijeResponse.ok) {
            pozicije = await pozicijeResponse.json();
            console.log('Pozicije response:', pozicije);
            console.log('Pozicije type:', typeof pozicije);
            console.log('Is pozicije array:', Array.isArray(pozicije));

            // Proveri da li je pozicije array pre poziva .find()
            if (Array.isArray(pozicije)) {
              pozicija = pozicije.find(p => p.id == radnik.pozicija_id);
            } else {
              console.error('Pozicije is not an array:', pozicije);
            }
          } else {
            const errorData = await pozicijeResponse.json();
            console.error(
              'Error loading pozicije:',
              pozicijeResponse.status,
              errorData
            );
          }
          console.log('Pozicija:', pozicija);

          // Uƒçitaj podatke o otkazu ako je otkazId prosleƒëen
          let otkaz = null;
          if (otkazId) {
            try {
              const otkazResponse = await fetch(`/api/otkazi/${otkazId}`);
              const otkazData = await otkazResponse.json();

              if (otkazResponse.ok && otkazData.success) {
                otkaz = otkazData.otkaz; // API vraƒáa podatke u 'otkaz' property
                console.log('Otkaz podatci:', otkaz);
                console.log('Datum otkaza iz API-ja:', otkaz.datum_otkaza);
              } else {
                console.warn(
                  'Gre≈°ka pri uƒçitavanju otkaza:',
                  otkazData.message
                );
              }
            } catch (otkazError) {
              console.warn('Gre≈°ka pri uƒçitavanju otkaza:', otkazError);
            }
          }

          // Popuni dokument
          populateDocument(radnik, firma, pozicija, otkaz);
        } catch (error) {
          console.error('Gre≈°ka pri uƒçitavanju podataka:', error);
          alert('Gre≈°ka pri uƒçitavanju podataka: ' + error.message);
        }
      }

      function populateDocument(radnik, firma, pozicija, otkaz) {
        const datumZaposlenja = new Date(
          radnik.datum_zaposlenja
        ).toLocaleDateString('sr-Latn-RS');

        // Koristiti datum otkaza ako postoji, inaƒçe datum prestanka ili dana≈°nji datum
        let datumIsteka;
        if (otkaz && otkaz.datum_otkaza) {
          datumIsteka = new Date(otkaz.datum_otkaza).toLocaleDateString(
            'sr-RS'
          );
        } else if (radnik.datum_prestanka) {
          datumIsteka = new Date(radnik.datum_prestanka).toLocaleDateString(
            'sr-RS'
          );
        } else {
          datumIsteka = new Date().toLocaleDateString('sr-Latn-RS');
        }

        // Generi≈°i broj re≈°enja i datum re≈°enja
        const today = new Date();
        const brojResenja = `${String(today.getMonth() + 1).padStart(
          2,
          '0'
        )}/${today.getFullYear().toString().slice(-2)}`;
        const datumResenja = today.toLocaleDateString('sr-Latn-RS');

        console.log('populateDocument - otkaz:', otkaz);
        console.log('populateDocument - formatiran datumIsteka:', datumIsteka);

        // Popunjavanje glavnih polja
        document.getElementById('nazivFirme').textContent = firma.naziv || '';
        if (document.getElementById('nazivFirme2')) {
          document.getElementById('nazivFirme2').textContent =
            firma.naziv || '';
        }

        document.getElementById('mestoFirme').textContent = firma.grad || 'Bar';
        if (document.getElementById('mestoFirme2')) {
          document.getElementById('mestoFirme2').textContent =
            firma.grad || 'Bar';
        }

        document.getElementById('brojResenja').textContent = brojResenja;
        document.getElementById('datumResenja').textContent = datumResenja;

        document.getElementById('zastupnikFirme').textContent =
          firma.direktor_ime_prezime || 'Direktor';

        // Podaci o radniku
        document.getElementById(
          'imeRadnika'
        ).textContent = `${radnik.ime} ${radnik.prezime}`;
        document.getElementById('jmbgRadnika').textContent = radnik.jmbg || '';
        document.getElementById('pozicijaRadnika').textContent = pozicija
          ? pozicija.naziv
          : '';

        // Datumi
        document.getElementById('datumIsteka').textContent = datumIsteka;
        if (document.getElementById('datumIsteka2')) {
          document.getElementById('datumIsteka2').textContent = datumIsteka;
        }
      }

      // PDF Download funkcija sa print stilovima
      function downloadPDF() {
        if (typeof ExportUtils !== 'undefined') {
          // Primeni print stilove pre export-a
          applyPrintStylesForPDF();

          ExportUtils.exportToPDF({
            containerSelector: '.document-container',
            filePrefix: 'Istek_ugovora',
            getFileName: () => {
              const radnikIme =
                document.getElementById('imeRadnika')?.textContent?.trim() ||
                'Radnik';
              const datum = new Date().toISOString().slice(0, 10);
              return `Istek_ugovora_${radnikIme.replace(
                /\s+/g,
                '_'
              )}_${datum}.pdf`;
            },
          })
            .then(() => {
              // Vrati originalne stilove nakon export-a
              removePrintStylesForPDF();
            })
            .catch(() => {
              // Vrati originalne stilove i ako je do≈°lo do gre≈°ke
              removePrintStylesForPDF();
            });
        } else {
          console.error('ExportUtils not loaded');
          alert('PDF export utilities are not available');
        }
      }

      // Funkcija za primenu print stilova za PDF
      function applyPrintStylesForPDF() {
        const style = document.createElement('style');
        style.id = 'pdf-print-styles';
        style.innerHTML = `
          .print-btn, .pdf-btn, .word-btn, .jpr-btn {
            display: none !important;
          }
          body {
            margin: 0 !important;
            background: white !important;
            font-size: 13pt !important;
          }
          .document-container {
            box-shadow: none !important;
            margin: 0 !important;
            padding: 25px !important;
            background: white !important;
            font-size: 13pt !important;
            line-height: 1.5 !important;
          }
          .two-column-section {
            width: 100% !important;
            border-collapse: collapse !important;
          }
          .two-column-section td {
            width: 50% !important;
            vertical-align: top !important;
          }
          .potvrda-prijema {
            margin-top: 25px !important;
            border-top: 1px solid #000 !important;
            padding-top: 20px !important;
          }
          h2 {
            font-size: 15pt !important;
            margin: 20px 0 !important;
          }
          p {
            margin: 8px 0 !important;
          }
          div {
            margin: 12px 0 !important;
          }
        `;
        document.head.appendChild(style);
      }

      // Funkcija za uklanjanje print stilova nakon PDF export-a
      function removePrintStylesForPDF() {
        const style = document.getElementById('pdf-print-styles');
        if (style) {
          style.remove();
        }
      }

      // Word Download funkcija (improved)
      function downloadWordCompact() {
        try {
          // Primeni print stilove i za Word
          applyPrintStylesForPDF();

          const container = document.querySelector('.document-container');
          if (!container) {
            throw new Error('Document container not found');
          }

          let content = container.innerHTML;

          // Ukloni dugmad i skriptove
          content = content.replace(/<script[^>]*>[\s\S]*?<\/script>/gi, '');
          content = content.replace(/class="[^"]*btn[^"]*"/gi, '');

          // Ukloni problematiƒçne inline stilove za flex
          content = content.replace(
            /style="[^"]*display:\s*flex[^"]*"/gi,
            'style=""'
          );
          content = content.replace(
            /style="[^"]*justify-content:[^"]*"/gi,
            'style=""'
          );

          // Oƒçisti prazne style atribute
          content = content.replace(/style=""/gi, '');

          // Generi≈°i ime fajla
          const radnikIme =
            document.getElementById('imeRadnika')?.textContent?.trim() ||
            'Radnik';
          const datum = new Date().toISOString().slice(0, 10);
          const fileName = `Istek_ugovora_${radnikIme.replace(
            /\s+/g,
            '_'
          )}_${datum}.doc`;

          // Kreiraj pravilno formatiran Word dokument
          const wordDocument = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office' 
                  xmlns:w='urn:schemas-microsoft-com:office:word' 
                  xmlns='http://www.w3.org/TR/REC-html40'>
            <head>
              <meta charset='utf-8'>
              <title>Istek ugovora o radu</title>
              <!--[if gte mso 9]>
              <xml>
                <w:WordDocument>
                  <w:View>Print</w:View>
                  <w:Zoom>90</w:Zoom>
                  <w:DoNotPromptForConvert/>
                  <w:DoNotPromptForConvert/>
                </w:WordDocument>
              </xml>
              <![endif]-->
              <style>
                @page {
                  size: A4;
                  margin: 2cm 1.5cm 2cm 1.5cm;
                }
                body { 
                  font-family: 'Times New Roman', serif; 
                  font-size: 13pt;
                  line-height: 1.5;
                  margin: 0;
                  padding: 25px;
                  color: #000;
                  background: white;
                }
                h1, h2, h5 { 
                  font-size: 15pt; 
                  font-weight: bold;
                  margin: 20px 0; 
                  text-align: center;
                }
                p {
                  margin: 8px 0;
                  text-align: justify;
                }
                table {
                  width: 100%;
                  border-collapse: collapse;
                }
                td {
                  vertical-align: top;
                  padding: 5px;
                }
                .signature-section {
                  margin-top: 40px;
                  text-align: right;
                }
                .potvrda-prijema {
                  margin-top: 25px;
                  border-top: 1px solid #000;
                  padding-top: 20px;
                }
                /* Zameni flex sa table za Word kompatibilnost */
                div[style*="display: flex"] {
                  display: table !important;
                  width: 100% !important;
                }
                div[style*="display: flex"] > div {
                  display: table-cell !important;
                  vertical-align: top !important;
                }
                /* Spreƒçi prelome unutar potpisa */
                .signature-section, 
                div[style*="justify-content: space-between"] {
                  page-break-inside: avoid !important;
                }
              </style>
            </head>
            <body>
              ${content}
            </body>
            </html>
          `;

          // Kreiraj i download fajl
          const blob = new Blob([wordDocument], {
            type: 'application/msword',
          });

          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          window.URL.revokeObjectURL(url);

          // Ukloni print stilove
          setTimeout(() => {
            removePrintStylesForPDF();
          }, 100);
        } catch (error) {
          console.error('Word export error:', error);
          alert('Gre≈°ka pri kreiranju Word dokumenta: ' + error.message);
          // Ukloni print stilove i u sluƒçaju gre≈°ke
          removePrintStylesForPDF();
        }
      }

      // JPR funkcija za istek ugovora - originalna verzija koja je radila
      function openJPRForIstek() {
        console.log('=== Debug openJPRForIstek ===');

        // ƒåitaj URL parametre direktno
        const urlParams = new URLSearchParams(window.location.search);
        const urlRadnikId = urlParams.get('radnikId');
        const urlFirmaId = urlParams.get('firmaId');

        console.log('URL radnikId:', urlRadnikId);
        console.log('URL firmaId:', urlFirmaId);

        if (!urlFirmaId) {
          alert('Gre≈°ka: nedostaju potrebni parametri za JPR (firmaId)');
          return;
        }

        // Uzmi ime i JMBG radnika iz dokumenta
        const imeRadnikaElement = document.getElementById('imeRadnika');
        const jmbgRadnikaElement = document.getElementById('jmbgRadnika');

        console.log('DOM elementi:', { imeRadnikaElement, jmbgRadnikaElement });
        console.log(
          'imeRadnikaElement textContent:',
          imeRadnikaElement?.textContent
        );
        console.log(
          'jmbgRadnikaElement textContent:',
          jmbgRadnikaElement?.textContent
        );

        const radnikImePrezime = imeRadnikaElement
          ? imeRadnikaElement.textContent.trim()
          : '';
        const radnikJmbg = jmbgRadnikaElement
          ? jmbgRadnikaElement.textContent.trim()
          : '';

        console.log('Radnik ime i prezime:', radnikImePrezime);
        console.log('Radnik JMBG:', radnikJmbg);

        if (!radnikImePrezime || !radnikJmbg) {
          console.warn(
            'Podaci nisu dostupni u DOM-u, poku≈°avam fallback sa API pozivom...'
          );

          // Fallback - pozovi API da dobijem podatke
          if (urlRadnikId) {
            fetchRadnikDataForJPR(urlRadnikId, urlFirmaId);
            return;
          } else {
            alert(
              'Gre≈°ka: ime ili JMBG radnika nije pronaƒëeno u dokumentu i nema radnikId u URL-u'
            );
            return;
          }
        }

        // Razdeli ime i prezime
        const imePrezimeParts = radnikImePrezime.split(' ');
        const radnikIme = imePrezimeParts[0] || '';
        const radnikPrezime = imePrezimeParts.slice(1).join(' ') || '';

        console.log('Podeljeno - Ime:', radnikIme, 'Prezime:', radnikPrezime);

        // Generi≈°i JPR URL-ove za odjavu (kao u originalnoj verziji)
        const koricaUrl = `jpr-korica.html?firmaId=${urlFirmaId}&context=odjava&radnikIme=${encodeURIComponent(
          radnikIme
        )}&radnikPrezime=${encodeURIComponent(
          radnikPrezime
        )}&radnikJmbg=${encodeURIComponent(radnikJmbg)}`;

        const dodatakUrl = `jpr-dodatak-b.html?firmaId=${urlFirmaId}&context=odjava&radnikIme=${encodeURIComponent(
          radnikIme
        )}&radnikPrezime=${encodeURIComponent(
          radnikPrezime
        )}&radnikJmbg=${encodeURIComponent(radnikJmbg)}`;

        console.log('JPR Korica URL:', koricaUrl);
        console.log('JPR Dodatak B URL:', dodatakUrl);

        // Otvori JPR korica u novom tabu (direktno window.open kao ranije)
        window.open(koricaUrl, '_blank');

        // Otvori JPR dodatak B nakon kratke pauze
        setTimeout(() => {
          window.open(dodatakUrl, '_blank');
        }, 500);
      }

      // Fallback funkcija za API poziv ako DOM nije popunjen
      async function fetchRadnikDataForJPR(radnikId, firmaId) {
        try {
          console.log('API Fallback - uƒçitavam podatke za radnikId:', radnikId);

          const radnikResponse = await fetch(`/api/radnici/id/${radnikId}`);
          const radnikData = await radnikResponse.json();

          console.log('API Fallback - dobio podatke:', radnikData);

          if (
            !radnikData ||
            !radnikData.ime ||
            !radnikData.prezime ||
            !radnikData.jmbg
          ) {
            alert('Gre≈°ka: nepotpuni podaci o radniku iz API-ja');
            return;
          }

          // Generi≈°i JPR URL-ove sa API podacima
          const koricaUrl = `jpr-korica.html?firmaId=${firmaId}&context=odjava&radnikIme=${encodeURIComponent(
            radnikData.ime
          )}&radnikPrezime=${encodeURIComponent(
            radnikData.prezime
          )}&radnikJmbg=${encodeURIComponent(radnikData.jmbg)}`;

          const dodatakUrl = `jpr-dodatak-b.html?firmaId=${firmaId}&context=odjava&radnikIme=${encodeURIComponent(
            radnikData.ime
          )}&radnikPrezime=${encodeURIComponent(
            radnikData.prezime
          )}&radnikJmbg=${encodeURIComponent(radnikData.jmbg)}`;

          console.log('API Fallback - JPR Korica URL:', koricaUrl);
          console.log('API Fallback - JPR Dodatak B URL:', dodatakUrl);

          // Otvori JPR stranice
          window.open(koricaUrl, '_blank');
          setTimeout(() => {
            window.open(dodatakUrl, '_blank');
          }, 500);
        } catch (error) {
          console.error('API Fallback - Gre≈°ka:', error);
          alert('Gre≈°ka pri uƒçitavanju podataka iz API-ja');
        }
      }

      // Uƒçitaj podatke kada se stranica uƒçita
      document.addEventListener('DOMContentLoaded', loadAndPopulateDocument);
    </script>
    <script src="cookie-consent.js"></script>
  </body>
</html>
