<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Odluka o sedmičnom odmoru</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Times New Roman", serif;
        background-color: #f8f9fa;
        padding: 20px;
      }
      .document-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        min-height: 297mm;
        padding: 40px;
      }
      .header {
        text-align: center;
        margin-bottom: 40px;
      }
      .title {
        font-size: 24px;
        font-weight: bold;
        margin: 20px 0;
        text-transform: uppercase;
      }
      .content {
        line-height: 1.8;
        text-align: justify;
      }
      .signature-section {
        margin-top: 80px;
        display: flex;
        justify-content: space-between;
      }
      .print-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }
      @media print {
        .print-btn {
          display: none;
        }
        body {
          background: white;
          padding: 0;
        }
        .document-container {
          box-shadow: none;
        }
      }
    </style>
  </head>
  <body>
    <button class="btn btn-primary print-btn" onclick="window.print()">
      <i class="fas fa-print me-2"></i>Štampaj
    </button>

    <div class="document-container">
      <div class="header">
        <div id="firmaHeader">
          <h3 id="firmaNaziv">Učitavanje...</h3>
          <p id="firmaAdresa">Učitavanje...</p>
        </div>
      </div>

      <div class="title">ODLUKA O KORIŠĆENJU SEDMIČNOG ODMORA</div>

      <div class="content">
        <p>
          Na osnovu člana 65. Zakona o radu ("Službeni glasnik RS", br. 24/2005,
          61/2005, 54/2009, 32/2013, 75/2014, 13/2017 - odluka US, 113/2017 i
          95/2018 - autentično tumačenje), poslodavac donosi:
        </p>

        <div style="margin: 30px 0">
          <h4 style="text-align: center">ODLUKU</h4>
        </div>

        <p><strong>Član 1.</strong></p>
        <p>
          Određuje se da zaposleni
          <strong id="radnikIme">_________________</strong>, JMBG
          <strong id="radnikJmbg">_________________</strong>, radno mesto
          <strong id="radnikPozicija">_________________</strong>, koristi
          sedmični odmor u periodu od
          <strong id="datumOd">_________________</strong> do
          <strong id="datumDo">_________________</strong>.
        </p>

        <p><strong>Član 2.</strong></p>
        <p>
          Za vreme korišćenja sedmičnog odmora zaposleni ima pravo na naknadu
          zarade u skladu sa zakonom.
        </p>

        <p><strong>Član 3.</strong></p>
        <p>Ova odluka stupa na snagu danom donošenja.</p>

        <p><strong>Član 4.</strong></p>
        <p>
          Protiv ove odluke zaposleni može podneti prigovor u roku od 8 dana od
          dana prijema odluke.
        </p>
      </div>

      <div class="signature-section">
        <div>
          <p><strong>Mesto i datum:</strong></p>
          <p>________________________</p>
        </div>
        <div style="text-align: center">
          <p><strong>POSLODAVAC</strong></p>
          <br /><br />
          <p>________________________</p>
          <p id="firmaZastupnik">Direktor</p>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const radnikId = urlParams.get("radnikId");
        const firmaId = urlParams.get("firmaId");

        if (radnikId && firmaId) {
          loadData(radnikId, firmaId);
        }
      });

      async function loadData(radnikId, firmaId) {
        try {
          // Učitaj podatke o radniku
          const radnikResponse = await fetch(`/api/radnici/id/${radnikId}`);
          const radnik = await radnikResponse.json();

          // Učitaj podatke o firmi
          const firmaResponse = await fetch(`/api/firme/id/${firmaId}`);
          const firma = await firmaResponse.json();

          // Popuni dokument
          document.getElementById("firmaNaziv").textContent = firma.naziv;
          document.getElementById(
            "firmaAdresa"
          ).textContent = `PIB: ${firma.pib} | ${firma.adresa}`;

          document.getElementById(
            "radnikIme"
          ).textContent = `${radnik.ime} ${radnik.prezime}`;
          document.getElementById("radnikJmbg").textContent = radnik.jmbg;
          document.getElementById("radnikPozicija").textContent =
            radnik.pozicija_naziv || "Nespecifikovano";

          // Postavi današnji datum
          const danas = new Date();
          const datumStr = danas.toLocaleDateString("sr-RS");

          // Ovo ćete zameniti sa stvarnim datumima kada budete imali formu
          document.getElementById("datumOd").textContent = "__/__/____";
          document.getElementById("datumDo").textContent = "__/__/____";
        } catch (error) {
          console.error("Greška pri učitavanju podataka:", error);
        }
      }
    </script>
  </body>
</html>
