<!DOCTYPE html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Ugovor o radu - Summa Summarum" />
    <meta name="author" content="Summa Summarum" />

    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="images/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="images/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="site.webmanifest" />

    <!-- Theme Preloader - sprečava bljeskanje dark/light mode -->
    <script src="components/theme-preloader.js"></script>

    <title>Ugovor o radu</title>
    <link rel="stylesheet" href="global-components.css" />
    <!-- PDF Export biblioteka -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
      body {
        font-family: "Times New Roman", serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        background-color: #f9f9f9;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background-color: white;
        padding: 40px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1,
      h2 {
        text-align: center;
        color: #333;
      }
      h1 {
        font-size: 24px;
        margin-bottom: 30px;
        text-transform: uppercase;
      }
      h2 {
        font-size: 18px;
        margin: 20px 0;
      }
      .article {
        margin: 20px 0;
      }
      .article-title {
        font-weight: bold;
        text-align: center;
        margin: 15px 0 10px 0;
      }
      .signature-section {
        display: flex;
        justify-content: space-between;
        margin-top: 50px;
        padding-top: 20px;
      }
      .signature {
        text-align: center;
        width: 200px;
      }
      .signature-line {
        border-bottom: 1px solid #333;
        margin-bottom: 5px;
        height: 40px;
      }
      .print-button,
      .pdf-button,
      .word-button {
        position: fixed;
        right: 20px;
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 120px;
        justify-content: center;
      }

      .print-button {
        top: 20px;
        background-color: #007bff;
      }

      .pdf-button {
        top: 80px;
        background-color: #dc3545;
      }

      .word-button {
        top: 140px;
        background-color: #6f42c1;
      }

      .print-button:hover,
      .pdf-button:hover,
      .word-button:hover {
        opacity: 0.8;
      }

      @media print {
        .print-button,
        .pdf-button,
        .word-button {
          display: none !important;
        }
        body {
          background-color: white;
          padding: 0;
        }
        .container {
          box-shadow: none;
          padding: 20px;
        }

        /* Ukloni header i footer sa datumom i linkom */
        @page {
          margin: 0.5in;
          size: A4;
        }

        /* Sakrij default browser header/footer */
        html,
        body {
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
      }
    </style>
  </head>
  <body>
    <button class="print-button" onclick="window.print()">🖨️ Štampaj</button>
    <button class="pdf-button" onclick="downloadPDF()">📄 PDF</button>
    <button class="word-button" onclick="downloadWordCompact()">📝 Word</button>

    <div class="container">
      <p>
        Na osnovu čl. 29, 30 tač.1 i 31. Zakona o radu (»Sl.list CG«.br.74/2019,
        ... 68/21 u daljem tekstu: ZAKON), odredbi Opšteg kolektivnog ugovora
        (»Sl.list CG« br. 150/2022), čl.16. Zakon o zaštiti i zdravlju na radu
        (»Sl.list CG« br.34/14 i 44/18), čl.1. Pravilnika o pitanjima iz zaštite
        na radu koja treba urediti ugovorom o radu (»Sl.list RCG« br.67/05) i
        čl.7 Zakona o zabrani zlostavljanja na radu (»Sl.list CG«, br.30/12 i
        54/16) dana zaključuje 01.07.2025 se sledeći
      </p>

      <h1>
        UGOVOR O RADU<br />na <span id="tip-ugovora">odredjeno</span> vrijeme
      </h1>

      <p>
        <strong>POSLODAVAC:</strong>
        <span id="firma-naziv">MURIZ D.O.O.</span> PIB:
        <span id="firma-pib">02068974</span><br />
        adresa: <span id="firma-adresa">MILA BOSKOVICA</span> koga zastupa
        izvršni direktor <span id="direktor-ime">SPIČANOVIĆ VOJIN</span>
      </p>

      <p>
        <strong>ZAPOSLENI:</strong>
        <span id="radnik-ime-prezime">DEJAN NOVOVIĆ</span> iz Bara jmbg:
        <span id="radnik-jmbg">0506981250010</span>, sa adresom stanovanja:
        <span id="radnik-adresa">Bar, Ulica 123</span>, <br />
      </p>
      <p>
        Ovim ugovorom se uredjuju odnosi po osnovu rada izmedju poslodavca i
        zaposlenog i utvrdjuju medjusobna prava, obaveze i odgovornosti u skladu
        sa odredbama Zakona o radu, Opšteg kolektivnog ugovora i akata
        poslodavca.
      </p>

      <div class="article">
        <div class="article-title">Član 1.</div>
        <p>
          Zaposleni zasniva radni odnos na radnom mjestu
          <span id="pozicija-naziv">rukovalac građevi</span> u prostorijama
          poslodavca.<br />
          U obavljanju poslova iz prethodnog stava zaposleni:
        </p>
        <div id="pozicija-opis">
          <p>
            - Upravljanje mašinama: Rukovalac upravlja različitim građevinskim
            mašinama kao što su bageri, buldožeri, utovarivači, rovokopači,
            valjci, kranovi i druge specijalizovane mašine.<br />
            -Održavanje mašina: Redovno pregledanje, čišćenje i osnovno
            održavanje mašina kako bi se osiguralo da su u ispravnom stanju za
            rad. To uključuje proveru ulja, goriva, rashladne tečnosti i drugih
            važnih komponenti.
          </p>
        </div>
      </div>

      <div class="article">
        <div class="article-title">Član 2.</div>
        <p>
          Radni odnos se zasniva na
          <span id="tip-ugovora-clan2">određeno</span> vrijeme za period od
          <span id="datum-zaposlenja-clan2">01.07.2025</span
          ><span id="do-datum-prestanka-wrapper">
            do <span id="datum-prestanka-clan2">31.12.2025</span></span
          >
          godine.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 3.</div>
        <p>
          Zaposleni stupa na rad dana
          <span id="datum-stupanja">01.07.2025</span> godine.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 4.</div>
        <p>
          Zaposlenom pripada mjesečna zarada u neto iznosu od
          <span id="visina-zarade">800,00</span> eura u skladu sa čl.11 Opšteg
          kolektivnog ugovora (Sl. list CG 37/19). Minimalna zarada, u neto
          iznosu, ne može biti niža od 600,00 eura, dok Vlada ne utvrdi
          drugačije.
        </p>
        <p>
          Zarada zaposlenog uvećava se po času za svaku zapocetu godinu radnog
          staža i to:<br />
          - do 10 godina 0.5 %<br />
          - od 10-20 godina 0.75 %<br />
          - preko 20 godina 1 %
        </p>
        <p>
          Zarada zaposlenog uvećava se po času :<br />
          - 40% za rad noću ( izmedju 22 sata i 6 sat narednog dana )<br />
          - 150% za rad na dane drzavnog ili vjerskog praznika<br />
          - 40 % za rad duzi od punog radnog vreinena ( prekovremeni rad )
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 5.</div>
        <p>
          Zaposlenom pripadaju i naknade zarada u skladu sa odredbama Opsteg
          kolektivnog ugovora i aktima poslodavca.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 6.</div>
        <p>
          Poslodavac je duzan da u rokovima utvrdjenim zakonom I opštim
          kolektivnim ugovorom vrši i isplatu zarada i naknada zarada zaposlenom
          iz čl. 4 i 5 ovog ugovora do kraja mjeseca za predhodni mjesec.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 7.</div>
        <p>
          Radni odnos se zasniva na
          <span id="tip-ugovora-clan7">odredjeno</span> vrijeme za period od
          <span id="datum-pocetka">01.07.2025</span
          ><span id="datum-kraja-wrapper">
            do <span id="datum-kraja">31.12.2025</span></span
          ><br />
          adresa <span id="mesto-rada">SUSANJ BB</span>
        </p>
        <p>
          Zaposleni obavlja poslove iz tac. 1 u prostorijama poslodavca, sa
          <span id="tip-radnog-vremena">PUNIM</span> radnim vremenom od
          <span id="sati-dnevno">8</span> (<span id="sati-dnevno-tekst"
            >osam</span
          >) časova dnevno, odnosno <span id="sati-nedeljno">40</span> (<span
            id="sati-nedeljno-tekst"
            >četrdeset</span
          >) nedeljno
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 8.</div>
        <p>
          Zaposleni ima pravo na dnevni odmor u toku rada u trajanju od 30
          minuta, i jedan dan sedmičnog odmora koji će koristiti nedjeljom odn.
          drugim danom po odluci izvršnog direktora Društva.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 9.</div>
        <p>
          Zaposleni ima pravo na godisnji odmor u trajanju od po 2 radna dana za
          svaki mjesec rada. Godišnji odmor se pored vremena iz prethodnog stava
          uvećava prema dužini radnog staža:<br />
          - Od 5 do 15 godina – 1 radni dan<br />
          - Od 15 do 25 godina – 2 radna dana<br />
          - Od 25 do 35 godina – 3 radna dana<br />
          - Preko 35 godina – 5 radnih dana
        </p>
        <p>
          Zaposleni ima pravo na odsustvo sa rada ( plaćeno odn. neplaćeno) u
          skladu sa odredbama Zakona o radu, Opšteg kolektivnog ugovora i akata
          poslodavca.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 10</div>
        <p>
          Zaposleni je dužan da :<br />
          - savjesno i odgovorno obavlja poslove radnog mjesta ,<br />
          - poštuje organizaciju rada i poslovanje kod poslodavca, kao i uslove
          i pravila poslodavca u vezi sa ispunjavanjem ugovorenih i drugih
          obaveza iz radnog odnosa,<br />
          - vodi računa i savjesno se odnosi prema sredstvima rada i
          materijalnim sredstvima poslodavca,<br />
          - obavijesti poslodavca o situacijama koje po mišljenju zaposlenog
          mogu da predstavljaju opasnost po život i zdravlje i sa kojima
          zaposleni ne može da se suoči na odgovarajući način, ili o svakoj
          situaciji za koju zaposleni ima objektivnih razloga da smatra da
          predstavlja neposrednu i ozbiljnu opasnost za njegov život ili
          zdravlje,<br />
          - u roku od 3 dana od dana promjene adrese stanovanja o tome
          obavijesti poslodavca,<br />
          - poštuje propise o Zaštiti i zdravlju na radu i pažljivo obavlja
          posao na način da štiti svoj život i zdravlje , kao i život i zdravlje
          drugih lica,<br />
          - postupa u skladu sa drugim obavezama utvrđenim zakonom, kolektivnim
          ugovorom, aktima poslodavca I ugovorom o radu<br />
          - najkasnije u roku od 3 dana od dana nastupanja privremene
          spriječenosti za rad, lično ili preko drugog lica dostavi potvrdu
          doktora medicine.<br />
          - Da izvještaj o privremenoj sprečenosti za rad dostavi u roku od 5
          dana od dana izdavanja
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 11</div>
        <p>
          Poslodavac je dužan da prijavi zaposlenog na obavezno socijalno
          osiguranje i blagovremeno uplaćuje doprinos za penzjsko, invalidsko i
          zdravstveno osiguranje i osiguranje za slučaj nezaposlenosti.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 12</div>
        <p>
          Za vrijeme trajanja radnog odnosa zaposleni može biti raspoređen na
          svako radno mjesto koje odgovara njegovoj stručnoj spremi, znanju i
          sposobnostima, ukoliko to zahtijevaju potrebe procesa i organizacije
          rada.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 13</div>
        <p>
          Zaposleni može biti privremeno raspoređen na radno mjesto čije
          obavljanje zahtijeva niži stepen stručne spreme od one koju ima, bez
          njegove saglasnosti, ukoliko to zahtijevaju potrebe procesa i
          organizacije rada , ali najduže do 30 dana.
        </p>
        <p>
          U slučaju iz predhodnog stava zaposlenom pripada zarada koju je imao
          na radnom mjestu na kome je do tada radio, ako je za njega to
          povoljnije
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 14</div>
        <p>
          Zaposleni se može rasporediti na rad u drugo mjesto rada kod ovog
          poslodavca, u slučaju potrebe procesa i organizacije rada, u skladu sa
          odredbama čl. 50 Zakona o radu.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 15</div>
        <p>
          Zaposleni se može rasporediti na rad u drugo mjesto rada kod ovog
          poslodavca, u slučaju potrebe procesa i organizacije rada, u skladu sa
          odredbama čl. 50 Zakona o radu.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 16</div>
        <p>
          Poslodavac je dužan da zaposlenom obezbijedi sredstva i mjere zaštite
          na radu u skladu sa odredbama Zakona o zaštiti i zdravlju na radu (
          SI. List CG 34/14) i Akta o zaštiti na radu poslodavca.
        </p>
        <p>
          Zaposleni je dužan da se prilikom zaključenja ovog ugovora o radu
          upozna sa mjerama i sredstvima zaštite na radu, te da se u radu strogo
          pridržava propisanih mjera .
        </p>
        <p>
          Nepoštovanje utvrđenih propisa i mjera iz oblasti zaštite na radu
          predstavlja težu povredu radne discipline zbog koje se izriče mjera
          prestanak radnog odnosa.
        </p>
        <p>
          Prava, obaveze i odgovomosti zaposlenog i poslodavca koje se odnose na
          zaštitu i zdravlje na radu uredjuju se aneksom ugovora odn. posebnim
          aktom poslodavca.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 17</div>
        <p>
          Zaposleni je dužan da poslove radnog mjesta obavlja savjesno i
          odgovorno skladu sa aktima poslodavca, zahjevima radnog mjesta i
          nalozima rukovodioca procesa rada
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 18</div>
        <p>
          Zaposlenom prestaje radni odnos u slučajevima, na način i pod uslovima
          utvrđenim Zakonom, Kolektivnim ugovorom i aktima poslodavca.
        </p>
        <p>
          Ovaj Ugovor o radu raskida se zbog sledećih povreda radnih obaveza:<br />
          - neizvršavanjem radnih i drugih obaveza,<br />
          - nesavjesno izvršavanje radnih i drugih obaveza,<br />
          - neblagovremeno i nemarno izvršavanje radnih obaveza,<br />
          - pronevjera ili krađa imovine preduzeća,<br />
          - nezakonito raspolaganje sredstvima preduzeća,<br />
          - neostvarenje predvidenih rezultata rada iz neopravdanih razloga,<br />
          - povreda propisa o zaštiti požara, eksplozije, elementarnih nepogoda
          i štetnih djelovanja otrovnih i drugih štetnih materija, kao i povreda
          propisa i nepreduzimanje mjera radi zaštite zaposlenih, sredstava rada
          i životne sredine,<br />
          - zloupotreba položaja i prekoračenja datih ovlašćenja,<br />
          - odavanje poslovne i druge tajne,<br />
          - zloupotreba prava korišćenja bolovanja,<br />
          - ometanje jednog ili više zaposlenih u procesu rada kojim se otežava
          izvršenje radnih obaveza,<br />
          - odbijanje zaposlenog da obavlja poslove radnog mjesta na koje je
          trajno - privremeno raspoređen,<br />
          - falsifikovanje novčanih i drugih dokumenata,<br />
          - povreda radne obaveze koja predstavlja krivično djelo,<br />
          - dolazak na rad u napitom stanju ili upotreba alkohola i drugih
          narkotičkih sredstava u toku rada,<br />
          - neopravdano napuštanje radnog mjesta prije završetka radnog
          vremena,<br />
          - neuredno držanje dokumenata i sredstava rada,<br />
          - nedovoljno preduzimanje mjera zaštite na radu ili zaštite radnika na
          rad ili zaštite imovine preduzeća,<br />
          - prouzrokovanje materijalne štete usled krajnje nepažnje ili
          namjere,<br />
          - pokušaj krađe, posticaj na krađu ili saučesništvo u krađi imovine u
          preduzeću,<br />
          - neopravdano izostajanje sa rada 5 radnih dana.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 19</div>
        <p>
          Zaposlenom prestaje radni odnos istekom roka iz tačke 2. ovog ugovora
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 20</div>
        <p>
          Ovaj ugovor se može raskinuti i prije isteka roka iz tačke 2.
          sporazumom poslodavca i zaposlenog, kojim će se utvrdit rokovi i
          uslovi prestanka radnog odnosa.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 21</div>
        <p>
          Zaposleni može otkazati ovaj ugovor o radu u pisanoj formi , ist mora
          biti ovjeren kod strane notara, suda ili organa lokalne uprave, i
          dostavljen poslodavcu u pisanoj formi najmanje 30 dana prije dana
          prestanka radnog odnosa, osim ako se poslodavca i zaposleni drugačije
          ne dogovore
        </p>
        <p>
          U slučaju da zaposleni ne ispoštuje otkazni rok poslodavac ima pravo
          na naknadu štete , u skladu sa odredbama Zakona o radu.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 22</div>
        <p>
          Za slucaj otkazivanja ovog ugovora o radu ugovara se otkazni rok od 30
          dana.<br />
          Na sva pitanja vezana za otkazni rok neposredno se primjenjuju odredbe
          čl. 177 Zakona o radu
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 23</div>
        <p>
          Ukoliko zaposleni umišljajem ili iz nehata povrijedi radnu obavezu ili
          se ne pridrzava odluke koju je donio poslodavac, odgovara za učinjenu
          povredu radne obaveze.
        </p>
        <p>
          Vrste povreda radnih obaveza, mjere za povrede radnih obaveza i
          postupak utvrdjivanja odgovornosti uredjuju se aktom o dispciplinskoj
          odgovomosti poslodavca, u skladu sa odredbama Zakona o radu.
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 24</div>
        <p>
          Na sve što nije predviđeno ovim ugovorom neposredno će se
          primjenjivati odredbe Zakona i opšteg kolektivnog ugovora
        </p>
      </div>

      <div class="article">
        <div class="article-title">Član 25</div>
        <p>
          Ovaj ugovor se smatra zaključenim kada ga potpišu poslodavac i
          zaposleni.
        </p>
      </div>

      <div class="signature-section">
        <div class="signature">
          <div class="signature-line"></div>
          <p><strong>POSLODAVAC</strong></p>
        </div>
        <div class="signature">
          <div class="signature-line"></div>
          <p><strong>ZAPOSLENI</strong></p>
        </div>
      </div>
    </div>

    <script>
      async function popuniUgovor(ugovorId) {
        try {
          const response = await fetch(`/api/contracts/${ugovorId}`);
          const ugovor = await response.json();

          // Koristi novu centralizovanu funkciju za popunjavanje
          popuniUgovorSaPodacima(ugovor);
        } catch (error) {
          console.error("Greška pri dohvaćanju ugovora:", error);
        }
      }

      async function popuniUgovorPoRadniku(radnikId, firmaId) {
        try {
          // Učitaj podatke o radniku i firmi direktno
          const [radnikResponse, firmaResponse] = await Promise.all([
            fetch(`/api/radnici/id/${radnikId}`),
            fetch(`/api/firme/id/${firmaId}`),
          ]);

          const radnik = await radnikResponse.json();
          const firma = await firmaResponse.json();

          // Kreiraj ugovor objekat u istom formatu kao što API vraća
          const ugovor = {
            radnik_tip_ugovora: radnik.tip_ugovora,
            firma_naziv: firma.naziv,
            firma_pib: firma.pib,
            firma_adresa: firma.adresa,
            direktor_ime_prezime: firma.direktor_ime_prezime,
            radnik_ime: radnik.ime,
            radnik_prezime: radnik.prezime,
            radnik_jmbg: radnik.jmbg,
            radnik_grad: radnik.grad,
            radnik_adresa: radnik.adresa,
            pozicija_naziv: radnik.pozicija_naziv,
            opis_poslova: radnik.opis_poslova,
            datum_zaposlenja: radnik.datum_zaposlenja,
            datum_prestanka: radnik.datum_prestanka,
            visina_zarade: radnik.visina_zarade,
            tip_radnog_vremena: radnik.tip_radnog_vremena,
          };

          // Pozovi postojeću logiku popunjavanja sa kreiranim objektom
          popuniUgovorSaPodacima(ugovor);
        } catch (error) {
          console.error("Greška pri dohvaćanju podataka za ugovor:", error);
        }
      }

      // Funkcija za transformaciju grada u genitiv (iz + grad)
      function transformisiGradUPadez(grad) {
        if (!grad) return "Bara"; // Default vrednost

        // Ukloni razmake i pretvori u lowercase za poređenje
        const gradLower = grad.trim().toLowerCase();

        // Mapa najčešćih gradova sa njihovim padežnim oblicima
        const gradoviPadezi = {
          bar: "Bara",
          budva: "Budve",
          podgorica: "Podgorice",
          nikšić: "Nikšića",
          niksic: "Nikšića",
          "herceg novi": "Herceg Novog",
          cetinje: "Cetinja",
          ulcinj: "Ulcinja",
          kotor: "Kotora",
          tivat: "Tivta",
          pljevlja: "Pljevalja",
          "bijelo polje": "Bijelog Polja",
          berane: "Berana",
          andrijevica: "Andrijevice",
          danilovgrad: "Danilovgrada",
          kolašin: "Kolašina",
          kolasin: "Kolašina",
          mojkovac: "Mojkovca",
          plav: "Plava",
          rožaje: "Rožaja",
          rozaje: "Rožaja",
          šavnik: "Šavnika",
          savnik: "Šavnika",
          žabljak: "Žabljaka",
          zabljak: "Žabljaka",
          petnjica: "Petnjice",
          gusinje: "Gusinja",
          tuzi: "Tuzija",
        };

        // Provjeri da li grad postoji u mapi
        if (gradoviPadezi[gradLower]) {
          return gradoviPadezi[gradLower];
        }

        // Osnovna pravila za nepoznate gradove
        const gradOriginal = grad.trim();

        // Gradovi koji se završavaju na -a (ženski rod)
        if (gradOriginal.endsWith("a")) {
          return gradOriginal.slice(0, -1) + "e";
        }

        // Gradovi koji se završavaju na -o (srednji rod)
        if (gradOriginal.endsWith("o")) {
          return gradOriginal.slice(0, -1) + "a";
        }

        // Gradovi koji se završavaju na suglasnik (muški rod)
        // Dodaj -a na kraj
        return gradOriginal + "a";
      }

      function popuniUgovorSaPodacima(ugovor) {
        // Popuni tip ugovora
        const tipTekst =
          ugovor.radnik_tip_ugovora === "na_neodredjeno"
            ? "neodređeno"
            : "određeno";
        document.getElementById("tip-ugovora").textContent = tipTekst;
        document.getElementById("tip-ugovora-clan7").textContent = tipTekst;
        document.getElementById("tip-ugovora-clan2").textContent = tipTekst;

        // Popuni podatke o firmi
        document.getElementById("firma-naziv").textContent = ugovor.firma_naziv;
        document.getElementById("firma-pib").textContent = ugovor.firma_pib;
        document.getElementById("firma-adresa").textContent =
          ugovor.firma_adresa || "MILA BOSKOVICA";
        document.getElementById("direktor-ime").textContent =
          ugovor.direktor_ime_prezime || "SPIČANOVIĆ VOJIN";

        // Popuni podatke o radniku
        const radnikImePrezime = `${ugovor.radnik_prezime} ${ugovor.radnik_ime}`;
        document.getElementById("radnik-ime-prezime").textContent =
          radnikImePrezime.toUpperCase();
        document.getElementById("radnik-jmbg").textContent = ugovor.radnik_jmbg;

        // Transformiši grad u odgovarajući padež
        const gradUPadežu = transformisiGradUPadez(ugovor.radnik_grad);
        document.getElementById("radnik-adresa").textContent = gradUPadežu;

        // Popuni datume
        const datumZaposlenja = new Date(ugovor.datum_zaposlenja);
        const formatiraniDatumZaposlenja =
          datumZaposlenja.toLocaleDateString("sr-Latn-RS");

        document.getElementById("datum-pocetka").textContent =
          formatiraniDatumZaposlenja;
        document.getElementById("datum-stupanja").textContent =
          formatiraniDatumZaposlenja;
        document.getElementById("datum-zaposlenja-clan2").textContent =
          formatiraniDatumZaposlenja;

        // Prikaži/sakrij datum kraja za određeno/neodređeno vreme
        const datumKrajaWrapper = document.getElementById(
          "datum-kraja-wrapper"
        );
        const doDatumPrestankaWrapper = document.getElementById(
          "do-datum-prestanka-wrapper"
        );

        if (ugovor.radnik_tip_ugovora === "na_neodredjeno") {
          datumKrajaWrapper.style.display = "none";
          doDatumPrestankaWrapper.style.display = "none";
        } else if (ugovor.datum_prestanka) {
          const datumPrestanka = new Date(ugovor.datum_prestanka);
          const formatiraniDatumPrestanka =
            datumPrestanka.toLocaleDateString("sr-Latn-RS");
          document.getElementById("datum-kraja").textContent =
            formatiraniDatumPrestanka;
          document.getElementById("datum-prestanka-clan2").textContent =
            formatiraniDatumPrestanka;
          datumKrajaWrapper.style.display = "inline";
          doDatumPrestankaWrapper.style.display = "inline";
        }

        // Popuni mesto rada
        document.getElementById("mesto-rada").textContent =
          ugovor.mesto_rada || "SUSANJ BB";

        // Popuni poziciju
        document.getElementById("pozicija-naziv").textContent =
          ugovor.pozicija_naziv || "rukovalac građevi";

        // Popuni opis pozicije
        const pozicijaOpisDiv = document.getElementById("pozicija-opis");
        if (ugovor.opis_poslova) {
          pozicijaOpisDiv.innerHTML = `<p>${ugovor.opis_poslova}</p>`;
          console.log("Popunjen opis pozicije iz baze:", ugovor.opis_poslova);
        } else {
        }

        // Popuni radno vreme na osnovu tip_radnog_vremena iz baze
        let satiDnevno = 8;
        let satiNedeljno = 40;

        if (ugovor.tip_radnog_vremena) {
          switch (ugovor.tip_radnog_vremena) {
            case "puno_8h":
              satiDnevno = 8;
              satiNedeljno = 40;
              break;
            case "skraceno_6h":
              satiDnevno = 6;
              satiNedeljno = 30;
              break;
            case "skraceno_4h":
              satiDnevno = 4;
              satiNedeljno = 20;
              break;
            case "skraceno_2h":
              satiDnevno = 2;
              satiNedeljno = 10;
              break;
            default:
              satiDnevno = 8;
              satiNedeljno = 40;
          }
        }

        // Funkcija za konvertovanje broja u tekst
        const brojUTekst = (broj) => {
          const brojevi = {
            2: "dva",
            4: "četiri",
            6: "šest",
            8: "osam",
            10: "deset",
            20: "dvadeset",
            30: "trideset",
            40: "četrdeset",
          };
          return brojevi[broj] || broj.toString();
        };

        // Određuj tip radnog vremena
        let tipRadnogVremena = "PUNIM";
        if (satiDnevno < 8) {
          tipRadnogVremena = "SKRAĆENIM";
        }

        document.getElementById("tip-radnog-vremena").textContent =
          tipRadnogVremena;
        document.getElementById("sati-dnevno").textContent = satiDnevno;
        document.getElementById("sati-dnevno-tekst").textContent =
          brojUTekst(satiDnevno);
        document.getElementById("sati-nedeljno").textContent = satiNedeljno;
        document.getElementById("sati-nedeljno-tekst").textContent =
          brojUTekst(satiNedeljno);

        // Popuni visinu zarade
        if (ugovor.visina_zarade) {
          const formatiranZarada = parseFloat(
            ugovor.visina_zarade
          ).toLocaleString("sr-Latn-RS", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          });
          document.getElementById("visina-zarade").textContent =
            formatiranZarada;
        }

        console.log("Ugovor uspešno popunjen:", ugovor);
      }

      // Kada se stranica učita, popuni ugovor
      document.addEventListener("DOMContentLoaded", function () {
        // Dobij ugovorId ili radnikId iz URL parametara
        const urlParams = new URLSearchParams(window.location.search);
        const ugovorId = urlParams.get("ugovor");
        const radnikId = urlParams.get("radnikId");
        const firmaId = urlParams.get("firmaId");

        // Popuni ugovor kada se stranica učita
        if (ugovorId) {
          // Postojeći način - preko ugovor ID-a
          popuniUgovor(ugovorId);
        } else if (radnikId && firmaId) {
          // Novi način - direktno preko radnik i firma ID-a
          popuniUgovorPoRadniku(radnikId, firmaId);
        } else {
          // Fallback
          popuniUgovor(1);
        }
      });

      // ============================================
      // PDF EXPORT FUNKCIJA
      // ============================================
      async function downloadPDF() {
        try {
          // Sakrij dugmad tokom snimanja
          document.querySelector(".print-button").style.display = "none";
          document.querySelector(".pdf-button").style.display = "none";
          document.querySelector(".word-button").style.display = "none";

          const { jsPDF } = window.jspdf;
          const element = document.querySelector(".container");

          // Kreiranje canvas-a od HTML-a
          const canvas = await html2canvas(element, {
            scale: 2,
            useCORS: true,
            allowTaint: false,
          });

          const imgData = canvas.toDataURL("image/png");
          const pdf = new jsPDF("p", "mm", "a4");

          const imgWidth = 210;
          const pageHeight = 295;
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          let heightLeft = imgHeight;

          let position = 0;

          pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;

          while (heightLeft >= 0) {
            position = heightLeft - imgHeight;
            pdf.addPage();
            pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;
          }

          // Generisanje imena fajla
          const radnikIme =
            document.getElementById("radnik-ime-prezime")?.textContent ||
            "Radnik";
          const firmaNaziv =
            document.getElementById("firma-naziv")?.textContent || "Firma";
          const fileName = `Ugovor_${radnikIme.replace(
            /\s+/g,
            "_"
          )}_${firmaNaziv.replace(/\s+/g, "_")}.pdf`;

          pdf.save(fileName);

          // Pokaži dugmad ponovo
          document.querySelector(".print-button").style.display = "flex";
          document.querySelector(".pdf-button").style.display = "flex";
          document.querySelector(".word-button").style.display = "flex";
        } catch (error) {
          console.error("Greška pri kreiranju PDF-a:", error);
          alert("Greška pri kreiranju PDF-a. Pokušajte ponovo.");
          document.querySelector(".print-button").style.display = "flex";
          document.querySelector(".pdf-button").style.display = "flex";
          document.querySelector(".word-button").style.display = "flex";
        }
      }

      // ============================================
      // WORD EXPORT FUNKCIJA
      // ============================================
      // ============================================
      // WORD EXPORT KOMPAKT FUNKCIJA - MANJE MARGINE
      // ============================================
      function downloadWordCompact() {
        try {
          // Uzmi sadržaj ugovora
          const container = document.querySelector(".container");
          let content = container.innerHTML;

          // Optimizuj sadržaj za kompaktni format
          content = content.replace(/<br\s*\/?>/gi, " ");
          content = content.replace(/\s+/g, " ");

          // Generisanje naziva fajla
          const radnikIme =
            document.getElementById("radnik-ime-prezime")?.textContent ||
            "Radnik";
          const firmaNaziv =
            document.getElementById("firma-naziv")?.textContent || "Firma";
          const fileName = `Ugovor_Kompakt_${radnikIme.replace(
            /\s+/g,
            "_"
          )}_${firmaNaziv.replace(/\s+/g, "_")}.doc`;

          // Kreiranje kompaktnog Word dokumenta
          const wordContent = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office' 
                  xmlns:w='urn:schemas-microsoft-com:office:word' 
                  xmlns='http://www.w3.org/TR/REC-html40'>
            <head>
              <meta charset='utf-8'>
              <title>Ugovor o radu - Kompakt</title>
              <!--[if gte mso 9]>
              <xml>
                <w:WordDocument>
                  <w:View>Print</w:View>
                  <w:Zoom>90</w:Zoom>
                  <w:DoNotPromptForConvert/>
                </w:WordDocument>
              </xml>
              <![endif]-->
              <style>
                @page {
                  size: A4;
                  margin: 1cm 0.7cm 1cm 0.7cm; /* Još manje margine - 0.7cm levo/desno */
                }
                body { 
                  font-family: 'Times New Roman', serif; 
                  font-size: 11pt; /* Manji font */
                  line-height: 1.2; /* Kompaktniji red spacing */
                  margin: 0;
                  padding: 0;
                  color: #000;
                  background: white;
                }
                h1 { 
                  font-size: 14pt; 
                  font-weight: bold;
                  margin: 10px 0 15px 0; 
                  text-transform: uppercase; 
                  text-align: center;
                  letter-spacing: 0.5px;
                }
                h2 { 
                  font-size: 12pt; 
                  margin: 10px 0 5px 0; 
                  text-align: center;
                }
                p {
                  margin: 4px 0; /* Manji margin između paragafa */
                  text-align: justify;
                  text-indent: 0;
                }
                .article { 
                  margin: 8px 0; /* Manji margin između članaka */
                  page-break-inside: avoid;
                }
                .article-title { 
                  font-weight: bold; 
                  text-align: center; 
                  margin: 8px 0 4px 0; 
                  font-size: 11pt;
                  text-decoration: underline;
                }
                .signature-section { 
                  display: table;
                  width: 100%;
                  margin-top: 25px; /* Manji top margin */
                  page-break-inside: avoid;
                }
                .signature { 
                  display: table-cell;
                  text-align: center; 
                  width: 45%; 
                  vertical-align: bottom;
                }
                .signature-line { 
                  border-bottom: 1px solid #000; 
                  margin-bottom: 3px; 
                  height: 25px; /* Manja visina linije */
                  width: 180px; /* Manja širina */
                  margin-left: auto;
                  margin-right: auto;
                }
                strong {
                  font-weight: bold;
                }
                /* Kompaktni stil za listu */
                ul, ol {
                  margin: 4px 0;
                  padding-left: 15px;
                }
                li {
                  margin: 1px 0;
                  line-height: 1.1;
                }
                /* Dodatni kompaktni stilovi */
                .compact-spacing {
                  margin: 2px 0;
                  line-height: 1.1;
                }
              </style>
            </head>
            <body>
              <div class="legal-text">
                ${content}
              </div>
            </body>
            </html>
          `;

          // Kreiranje blob-a i download-a
          const blob = new Blob([wordContent], {
            type: "application/msword;charset=utf-8",
          });

          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        } catch (error) {
          console.error(
            "Greška pri kreiranju kompaktnog Word dokumenta:",
            error
          );
          alert(
            "Greška pri kreiranju kompaktnog Word dokumenta. Pokušajte ponovo."
          );
        }
      }
    </script>
  </body>
</html>
